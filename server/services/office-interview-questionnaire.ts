/**
 * Office Building Interview Questionnaire
 * 
 * Complete question definitions with polarity logic, risk weights,
 * and threat/control mappings for the office building interview workflow.
 * 
 * Implements the RiskFixer AI-First Assessment Framework with:
 * - T×V×I formula (Threat × Vulnerability × Impact)
 * - Risk factor counting for vulnerability adjustment
 * - Threat-specific control recommendations
 * 
 * @author RiskFixer Team
 * @version 1.0
 * @see RiskFixer-Office-Building-Questions-With-Polarity.md
 * @see RiskFixer-Office-Building-Framework-UPGRADED.md
 */

// ============================================================================
// INTERFACES
// ============================================================================

export interface InterviewQuestion {
  id: string;
  section: OfficeSection;
  questionText: string;
  questionType: 'text' | 'multiple_choice' | 'rating' | 'yes_no' | 'checklist' | 'number';
  options?: string[];
  ratingScale?: { min: number; max: number; labels: string[] };
  required: boolean;
  followUpQuestions?: InterviewQuestion[];
  condition?: {
    questionId: string;
    expectedValue: string | string[];
  };
  
  // Risk mapping fields
  polarity: 'YES_GOOD' | 'YES_BAD' | 'RATING' | 'CONTEXT' | 'MULTIPLE_CHOICE';
  badAnswers?: string[];
  riskWeight: number;
  riskIndicators?: string[];
  ratingBadThreshold?: number;
  
  // Threat/control linkage
  informsThreat?: string[];
  informsVulnerability?: boolean;
  informsImpact?: boolean;
  suggestsControls?: string[];
  helpText?: string;
}

export interface SectionMetadata {
  id: string;
  name: OfficeSection;
  description: string;
  order: number;
}

// ============================================================================
// TYPE-SAFE SECTION DEFINITIONS
// ============================================================================

export const OFFICE_SECTIONS = [
  'Facility Overview',
  'Perimeter Security',
  'Parking Facilities',
  'Building Entry Points',
  'Interior Access Control',
  'Surveillance Systems',
  'Intrusion Detection',
  'Security Personnel & Procedures',
  'Emergency Preparedness',
  'Incident History Analysis',
  'Cyber-Physical Security',
  'Document & Data Security',
  'Loading Dock & Receiving',
] as const;

export type OfficeSection = typeof OFFICE_SECTIONS[number];

// ============================================================================
// OFFICE BUILDING THREAT DEFINITIONS
// ============================================================================

export const OFFICE_THREATS = [
  'unauthorized_access',
  'workplace_violence',
  'theft_burglary',
  'executive_targeting',
  'data_breach_physical',
  'terrorism_bomb_threat',
  'civil_disturbance',
  'insider_threat',
  'after_hours_intrusion',
  'vehicle_ramming',
  'active_shooter',
  'corporate_espionage',
] as const;

export type OfficeThreat = typeof OFFICE_THREATS[number];

// ============================================================================
// SECTION 1: FACILITY OVERVIEW (8 questions)
// ============================================================================

const SECTION_1_FACILITY_OVERVIEW: InterviewQuestion[] = [
  {
    id: 'overview_1',
    section: 'Facility Overview',
    questionText: 'What is the primary business function of this facility?',
    questionType: 'multiple_choice',
    options: [
      'Corporate headquarters',
      'Regional office',
      'Branch/satellite office',
      'Research & development',
      'Financial services/trading floor',
      'Legal/professional services',
      'Technology/software development',
      'Government/public sector',
      'Healthcare administration',
      'Call center/customer service',
      'Mixed use',
      'Other',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsThreat: ['data_breach_physical', 'corporate_espionage', 'executive_targeting'],
    informsImpact: true,
    helpText: 'Financial/legal/tech functions increase data theft threat likelihood',
  },
  {
    id: 'overview_2',
    section: 'Facility Overview',
    questionText: 'How many total employees work at this location?',
    questionType: 'multiple_choice',
    options: [
      '1-25 employees',
      '26-50 employees',
      '51-100 employees',
      '101-250 employees',
      '251-500 employees',
      '500+ employees',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    informsImpact: true,
    informsThreat: ['workplace_violence', 'insider_threat'],
    helpText: 'Larger workforce = harder to know everyone, increased insider threat surface',
  },
  {
    id: 'overview_3',
    section: 'Facility Overview',
    questionText: 'Is this a single-tenant building or multi-tenant shared space?',
    questionType: 'multiple_choice',
    options: [
      'Single-tenant - company occupies entire building',
      'Multi-tenant - company occupies entire floor(s)',
      'Multi-tenant - shared floor with other companies',
      'Co-working/shared office space',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    riskIndicators: ['multi-tenant', 'shared floor', 'co-working'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'theft_burglary', 'corporate_espionage'],
    helpText: 'Shared spaces reduce control over who enters the building',
  },
  {
    id: 'overview_4',
    section: 'Facility Overview',
    questionText: 'Does your company handle sensitive data or high-value intellectual property?',
    questionType: 'multiple_choice',
    options: [
      'Highly sensitive - regulated data (PII, PHI, financial)',
      'Moderately sensitive - proprietary business information',
      'Standard business data - no special sensitivity',
      'Unknown/unsure',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsImpact: true,
    informsThreat: ['data_breach_physical', 'corporate_espionage'],
    helpText: '"Highly sensitive" increases impact for data theft scenarios',
  },
  {
    id: 'overview_5',
    section: 'Facility Overview',
    questionText: 'Are there high-profile executives or public figures who work at this location?',
    questionType: 'yes_no',
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsThreat: ['executive_targeting', 'workplace_violence', 'terrorism_bomb_threat'],
    helpText: 'Executive presence increases targeting threat likelihood',
  },
  {
    id: 'overview_6',
    section: 'Facility Overview',
    questionText: 'What are your typical operating hours?',
    questionType: 'multiple_choice',
    options: [
      'Standard business hours (8am-6pm)',
      'Extended hours (6am-10pm)',
      '24/7 operations',
      'Variable/flexible hours',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'unauthorized_access'],
  },
  {
    id: 'overview_7',
    section: 'Facility Overview',
    questionText: 'Approximately how many visitors do you receive per day?',
    questionType: 'multiple_choice',
    options: [
      'Minimal (under 10)',
      'Moderate (10-50)',
      'High (50-100)',
      'Very high (100+)',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence'],
    helpText: 'Higher visitor volume makes screening more challenging',
  },
  {
    id: 'overview_8',
    section: 'Facility Overview',
    questionText: 'What is the approximate value of company assets at this location?',
    questionType: 'multiple_choice',
    options: [
      'Under $100,000',
      '$100,000 - $500,000',
      '$500,000 - $1 million',
      '$1 million - $5 million',
      'Over $5 million',
      'Unknown/prefer not to disclose',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsImpact: true,
    informsThreat: ['theft_burglary', 'after_hours_intrusion'],
  },
];

// ============================================================================
// SECTION 2: PERIMETER SECURITY (10 questions with follow-ups)
// ============================================================================

const SECTION_2_PERIMETER_SECURITY: InterviewQuestion[] = [
  {
    id: 'perimeter_1',
    section: 'Perimeter Security',
    questionText: 'Does the building have defined perimeter security?',
    questionType: 'multiple_choice',
    options: [
      'Yes - fenced perimeter with controlled access points',
      'Yes - secured parking structure only',
      'Partial - some areas secured',
      'No - building is directly adjacent to public sidewalk/street',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No - building is directly adjacent to public sidewalk/street'],
    riskWeight: 2,
    riskIndicators: ['no - building is directly'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'vehicle_ramming', 'terrorism_bomb_threat'],
    suggestsControls: ['perimeter_fencing', 'vehicle_barriers', 'setback_requirements'],
  },
  {
    id: 'perimeter_2',
    section: 'Perimeter Security',
    questionText: 'How would you rate the exterior lighting around the building perimeter?',
    questionType: 'rating',
    ratingScale: { min: 1, max: 5, labels: ['Very Poor', 'Poor', 'Adequate', 'Good', 'Excellent'] },
    required: true,
    polarity: 'RATING',
    ratingBadThreshold: 2,
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'vehicle_ramming', 'workplace_violence'],
    suggestsControls: ['perimeter_lighting', 'motion_activated_lighting'],
  },
  {
    id: 'perimeter_3',
    section: 'Perimeter Security',
    questionText: 'Is there landscaping or vegetation that could provide concealment near entry points?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    badAnswers: ['yes'],
    riskWeight: 1,
    riskIndicators: ['yes'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence', 'executive_targeting'],
    suggestsControls: ['cpted_landscaping', 'vegetation_management'],
  },
  {
    id: 'perimeter_4',
    section: 'Perimeter Security',
    questionText: 'Do you have CCTV coverage of the building perimeter?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'vehicle_ramming', 'after_hours_intrusion'],
    suggestsControls: ['perimeter_cctv', 'video_analytics'],
    followUpQuestions: [
      {
        id: 'perimeter_4a',
        section: 'Perimeter Security',
        questionText: 'What percentage of the building perimeter has camera coverage?',
        questionType: 'multiple_choice',
        options: [
          '100% coverage',
          '75-99% coverage',
          '50-74% coverage',
          '25-49%',
          'Less than 25%',
        ],
        required: true,
        polarity: 'MULTIPLE_CHOICE',
        badAnswers: ['Less than 25%', '25-49%'],
        riskWeight: 1,
        riskIndicators: ['25-49%', 'less than 25%'],
        condition: {
          questionId: 'perimeter_4',
          expectedValue: 'yes',
        },
        informsVulnerability: true,
        suggestsControls: ['expand_cctv_coverage'],
      },
    ],
  },
  {
    id: 'perimeter_5',
    section: 'Perimeter Security',
    questionText: 'Are there any vulnerable entry points (basement doors, roof access, service entrances)?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    riskWeight: 0,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'after_hours_intrusion', 'corporate_espionage'],
    followUpQuestions: [
      {
        id: 'perimeter_5a',
        section: 'Perimeter Security',
        questionText: 'How are these vulnerable entry points secured?',
        questionType: 'checklist',
        options: [
          'Card reader access control',
          'CCTV monitoring',
          'Alarm sensors',
          'Physical locks only',
          'Security patrol coverage',
          'No additional security',
        ],
        required: true,
        polarity: 'MULTIPLE_CHOICE',
        badAnswers: ['Physical locks only', 'No additional security'],
        riskWeight: 2,
        riskIndicators: ['physical locks only', 'no additional security'],
        condition: {
          questionId: 'perimeter_5',
          expectedValue: 'yes',
        },
        informsVulnerability: true,
        suggestsControls: ['vulnerable_entry_monitoring', 'electronic_access_control'],
      },
    ],
  },
  {
    id: 'perimeter_6',
    section: 'Perimeter Security',
    questionText: 'Are there vehicle barriers (bollards, planters, etc.) protecting pedestrian areas and building entrances?',
    questionType: 'multiple_choice',
    options: [
      'Yes - rated hostile vehicle mitigation (HVM)',
      'Yes - decorative barriers with some protection',
      'Partial - some areas protected',
      'No barriers',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No barriers'],
    riskWeight: 2,
    riskIndicators: ['no barriers'],
    informsVulnerability: true,
    informsThreat: ['vehicle_ramming', 'terrorism_bomb_threat'],
    suggestsControls: ['vehicle_barriers', 'hostile_vehicle_mitigation'],
  },
  {
    id: 'perimeter_7',
    section: 'Perimeter Security',
    questionText: 'What is the setback distance from the street/parking to the main building entrance?',
    questionType: 'multiple_choice',
    options: [
      'Over 100 feet',
      '50-100 feet',
      '25-50 feet',
      'Less than 25 feet',
      'Building is directly on street',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Less than 25 feet', 'Building is directly on street'],
    riskWeight: 1,
    riskIndicators: ['less than 25 feet', 'directly on street'],
    informsVulnerability: true,
    informsThreat: ['vehicle_ramming', 'terrorism_bomb_threat'],
    suggestsControls: ['setback_assessment', 'standoff_distance'],
  },
  {
    id: 'perimeter_8',
    section: 'Perimeter Security',
    questionText: 'Is there a security presence or guard post at the building perimeter?',
    questionType: 'multiple_choice',
    options: [
      '24/7 guard presence at perimeter',
      'Business hours guard presence',
      'Roving patrol only',
      'No perimeter security presence',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No perimeter security presence'],
    riskWeight: 1,
    riskIndicators: ['no perimeter security'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'vehicle_ramming', 'civil_disturbance'],
    suggestsControls: ['perimeter_guard', 'security_patrol'],
  },
];

// ============================================================================
// SECTION 3: PARKING FACILITIES (8 questions)
// ============================================================================

const SECTION_3_PARKING: InterviewQuestion[] = [
  {
    id: 'parking_1',
    section: 'Parking Facilities',
    questionText: 'What type of parking facility does the building have?',
    questionType: 'multiple_choice',
    options: [
      'Secure underground parking',
      'Secure above-ground parking structure',
      'Surface lot - controlled access',
      'Surface lot - open access',
      'Street parking only',
      'No dedicated parking',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Surface lot - open access', 'Street parking only', 'No dedicated parking'],
    riskWeight: 1,
    riskIndicators: ['open access', 'street parking', 'no dedicated'],
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'workplace_violence', 'vehicle_ramming'],
    suggestsControls: ['parking_access_control', 'parking_cctv'],
  },
  {
    id: 'parking_2',
    section: 'Parking Facilities',
    questionText: 'Is parking facility access controlled?',
    questionType: 'multiple_choice',
    options: [
      'Badge/credential required for entry',
      'Ticket/gate system',
      'Attendant-controlled',
      'Open - no access control',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Open - no access control'],
    riskWeight: 1,
    riskIndicators: ['open', 'no access control'],
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'vehicle_ramming', 'after_hours_intrusion'],
    suggestsControls: ['parking_access_control'],
  },
  {
    id: 'parking_3',
    section: 'Parking Facilities',
    questionText: 'Is there CCTV coverage in the parking facility?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'workplace_violence', 'after_hours_intrusion'],
    suggestsControls: ['parking_cctv'],
  },
  {
    id: 'parking_4',
    section: 'Parking Facilities',
    questionText: 'How would you rate the lighting in the parking facility?',
    questionType: 'rating',
    ratingScale: { min: 1, max: 5, labels: ['Very Poor', 'Poor', 'Adequate', 'Good', 'Excellent'] },
    required: true,
    polarity: 'RATING',
    ratingBadThreshold: 2,
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'workplace_violence'],
    suggestsControls: ['parking_lighting'],
  },
  {
    id: 'parking_5',
    section: 'Parking Facilities',
    questionText: 'Is there designated executive/VIP parking with enhanced security?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['executive_targeting'],
    suggestsControls: ['executive_parking'],
  },
  {
    id: 'parking_6',
    section: 'Parking Facilities',
    questionText: 'Are there emergency call stations or intercoms in the parking facility?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'theft_burglary'],
    suggestsControls: ['emergency_call_stations'],
  },
  {
    id: 'parking_7',
    section: 'Parking Facilities',
    questionText: 'Is pedestrian access from parking to building secure?',
    questionType: 'multiple_choice',
    options: [
      'Direct secure access (badge required)',
      'Through secured lobby only',
      'Multiple unsecured access points',
      'Open access',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Multiple unsecured access points', 'Open access'],
    riskWeight: 1,
    riskIndicators: ['unsecured', 'open access'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'after_hours_intrusion'],
    suggestsControls: ['parking_pedestrian_access'],
  },
  {
    id: 'parking_8',
    section: 'Parking Facilities',
    questionText: 'Have there been vehicle-related security incidents in the parking facility?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    badAnswers: ['yes'],
    riskWeight: 1,
    riskIndicators: ['yes'],
    informsThreat: ['theft_burglary', 'workplace_violence'],
  },
];

// ============================================================================
// SECTION 4: BUILDING ENTRY POINTS (10 questions)
// ============================================================================

const SECTION_4_ENTRY_POINTS: InterviewQuestion[] = [
  {
    id: 'entry_1',
    section: 'Building Entry Points',
    questionText: 'How many public entry points does the building have?',
    questionType: 'multiple_choice',
    options: [
      '1 main entrance only',
      '2-3 entrances',
      '4-5 entrances',
      'More than 5 entrances',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access'],
  },
  {
    id: 'entry_2',
    section: 'Building Entry Points',
    questionText: 'What type of access control is at the main entrance?',
    questionType: 'multiple_choice',
    options: [
      'Mantrap/security vestibule with badge',
      'Turnstiles with badge access',
      'Badge reader only',
      'Reception desk check-in only',
      'Open access during business hours',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Open access during business hours'],
    riskWeight: 2,
    riskIndicators: ['open access'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence', 'active_shooter'],
    suggestsControls: ['mantrap_entry', 'turnstiles', 'badge_access'],
  },
  {
    id: 'entry_3',
    section: 'Building Entry Points',
    questionText: 'Is there a staffed reception desk at the main entrance?',
    questionType: 'multiple_choice',
    options: [
      '24/7 staffed reception',
      'Staffed during business hours',
      'Part-time/occasional staffing',
      'No reception desk',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No reception desk'],
    riskWeight: 1,
    riskIndicators: ['no reception'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence'],
    suggestsControls: ['reception_desk', 'security_reception'],
  },
  {
    id: 'entry_4',
    section: 'Building Entry Points',
    questionText: 'Is there a formal visitor management system?',
    questionType: 'multiple_choice',
    options: [
      'Electronic visitor management with photo ID',
      'Electronic sign-in system',
      'Paper sign-in log',
      'No visitor tracking',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Paper sign-in log', 'No visitor tracking'],
    riskWeight: 2,
    riskIndicators: ['paper sign-in', 'no visitor tracking'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage', 'workplace_violence'],
    suggestsControls: ['visitor_management_system'],
  },
  {
    id: 'entry_5',
    section: 'Building Entry Points',
    questionText: 'Are visitors required to display badges while in the building?',
    questionType: 'multiple_choice',
    options: [
      'Yes - printed badges with photo',
      'Yes - printed badges without photo',
      'Yes - temporary stickers',
      'No visitor identification required',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No visitor identification required'],
    riskWeight: 1,
    riskIndicators: ['no visitor identification'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage'],
    suggestsControls: ['visitor_badges'],
  },
  {
    id: 'entry_6',
    section: 'Building Entry Points',
    questionText: 'Is escort required for visitors?',
    questionType: 'multiple_choice',
    options: [
      'Always - escort required throughout visit',
      'For sensitive areas only',
      'Escort to destination then unescorted',
      'No escort requirement',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No escort requirement'],
    riskWeight: 1,
    riskIndicators: ['no escort'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage', 'data_breach_physical'],
    suggestsControls: ['visitor_escort_policy'],
  },
  {
    id: 'entry_7',
    section: 'Building Entry Points',
    questionText: 'Are there anti-tailgating measures at entrances?',
    questionType: 'multiple_choice',
    options: [
      'Yes - mantrap/security vestibule',
      'Yes - optical turnstiles with detection',
      'Yes - guard observation',
      'Signage only',
      'No anti-tailgating measures',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Signage only', 'No anti-tailgating measures'],
    riskWeight: 2,
    riskIndicators: ['signage only', 'no anti-tailgating'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'insider_threat'],
    suggestsControls: ['anti_tailgating', 'mantrap', 'turnstiles'],
  },
  {
    id: 'entry_8',
    section: 'Building Entry Points',
    questionText: 'Are employee badges checked visually by security or reception?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage'],
    suggestsControls: ['badge_verification'],
  },
  {
    id: 'entry_9',
    section: 'Building Entry Points',
    questionText: 'Is there package/delivery screening at building entry?',
    questionType: 'multiple_choice',
    options: [
      'X-ray screening for all packages',
      'Visual inspection of packages',
      'Delivery to separate area (loading dock)',
      'No package screening',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No package screening'],
    riskWeight: 1,
    riskIndicators: ['no package screening'],
    informsVulnerability: true,
    informsThreat: ['terrorism_bomb_threat'],
    suggestsControls: ['package_screening', 'mail_room_security'],
  },
  {
    id: 'entry_10',
    section: 'Building Entry Points',
    questionText: 'Are after-hours entries logged and monitored?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'insider_threat'],
    suggestsControls: ['after_hours_access_logging'],
  },
];

// ============================================================================
// SECTION 5: INTERIOR ACCESS CONTROL (8 questions)
// ============================================================================

const SECTION_5_INTERIOR_ACCESS: InterviewQuestion[] = [
  {
    id: 'interior_1',
    section: 'Interior Access Control',
    questionText: 'Is there zone-based access control limiting movement within the building?',
    questionType: 'multiple_choice',
    options: [
      'Yes - comprehensive zone system',
      'Partial - some restricted areas',
      'Department-level only',
      'No internal access restrictions',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No internal access restrictions'],
    riskWeight: 2,
    riskIndicators: ['no internal access'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'insider_threat', 'corporate_espionage'],
    suggestsControls: ['zone_access_control'],
  },
  {
    id: 'interior_2',
    section: 'Interior Access Control',
    questionText: 'Are server rooms/IT infrastructure areas secured?',
    questionType: 'multiple_choice',
    options: [
      'Yes - biometric + badge access',
      'Yes - badge access only',
      'Yes - key lock only',
      'No dedicated security',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Yes - key lock only', 'No dedicated security'],
    riskWeight: 2,
    riskIndicators: ['key lock only', 'no dedicated security'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat', 'corporate_espionage'],
    suggestsControls: ['server_room_access', 'biometric_access'],
  },
  {
    id: 'interior_3',
    section: 'Interior Access Control',
    questionText: 'Is there enhanced access control for executive floors/suites?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['executive_targeting', 'workplace_violence'],
    suggestsControls: ['executive_access_control'],
  },
  {
    id: 'interior_4',
    section: 'Interior Access Control',
    questionText: 'Are stairwells access-controlled?',
    questionType: 'multiple_choice',
    options: [
      'Yes - badge required for all stairwell access',
      'Badge required for re-entry only',
      'Alarmed but not access controlled',
      'No stairwell security',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No stairwell security'],
    riskWeight: 1,
    riskIndicators: ['no stairwell security'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'after_hours_intrusion'],
    suggestsControls: ['stairwell_access_control'],
  },
  {
    id: 'interior_5',
    section: 'Interior Access Control',
    questionText: 'Are elevators floor-controlled by badge/credential?',
    questionType: 'multiple_choice',
    options: [
      'Yes - badge required for floor selection',
      'Yes - for restricted floors only',
      'No elevator access control',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No elevator access control'],
    riskWeight: 1,
    riskIndicators: ['no elevator access'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'executive_targeting'],
    suggestsControls: ['elevator_access_control'],
  },
  {
    id: 'interior_6',
    section: 'Interior Access Control',
    questionText: 'How often are access rights reviewed and updated?',
    questionType: 'multiple_choice',
    options: [
      'Quarterly review with manager approval',
      'Semi-annual review',
      'Annual review',
      'Only when issues arise',
      'Never formally reviewed',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Only when issues arise', 'Never formally reviewed'],
    riskWeight: 1,
    riskIndicators: ['only when issues', 'never formally'],
    informsVulnerability: true,
    informsThreat: ['insider_threat', 'unauthorized_access'],
    suggestsControls: ['access_review_process'],
  },
  {
    id: 'interior_7',
    section: 'Interior Access Control',
    questionText: 'Is access revoked promptly upon termination?',
    questionType: 'multiple_choice',
    options: [
      'Immediately upon termination decision',
      'Same day as departure',
      'Within 24 hours',
      'No formal process',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Within 24 hours', 'No formal process'],
    riskWeight: 2,
    riskIndicators: ['within 24 hours', 'no formal process'],
    informsVulnerability: true,
    informsThreat: ['insider_threat', 'workplace_violence', 'data_breach_physical'],
    suggestsControls: ['termination_access_procedures'],
  },
  {
    id: 'interior_8',
    section: 'Interior Access Control',
    questionText: 'Are lost/stolen credentials reported and deactivated promptly?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'insider_threat'],
    suggestsControls: ['credential_management'],
  },
];

// ============================================================================
// SECTION 6: SURVEILLANCE SYSTEMS (8 questions)
// ============================================================================

const SECTION_6_SURVEILLANCE: InterviewQuestion[] = [
  {
    id: 'surveillance_1',
    section: 'Surveillance Systems',
    questionText: 'Is there CCTV coverage at building entrances and exits?',
    questionType: 'multiple_choice',
    options: [
      'Yes - all entrances with facial capture quality',
      'Yes - all entrances standard quality',
      'Partial coverage',
      'No CCTV at entrances',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No CCTV at entrances'],
    riskWeight: 2,
    riskIndicators: ['no cctv'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence', 'theft_burglary'],
    suggestsControls: ['entrance_cctv'],
  },
  {
    id: 'surveillance_2',
    section: 'Surveillance Systems',
    questionText: 'Is there CCTV coverage in common areas (lobbies, hallways)?',
    questionType: 'multiple_choice',
    options: [
      'Comprehensive coverage',
      'Key areas only',
      'Minimal coverage',
      'No interior CCTV',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No interior CCTV'],
    riskWeight: 1,
    riskIndicators: ['no interior cctv'],
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'theft_burglary', 'insider_threat'],
    suggestsControls: ['interior_cctv'],
  },
  {
    id: 'surveillance_3',
    section: 'Surveillance Systems',
    questionText: 'Is CCTV footage actively monitored?',
    questionType: 'multiple_choice',
    options: [
      '24/7 live monitoring',
      'Business hours monitoring',
      'Event-triggered monitoring only',
      'Recording only - no live monitoring',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Recording only - no live monitoring'],
    riskWeight: 1,
    riskIndicators: ['recording only', 'no live monitoring'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence'],
    suggestsControls: ['cctv_monitoring'],
  },
  {
    id: 'surveillance_4',
    section: 'Surveillance Systems',
    questionText: 'How long is CCTV footage retained?',
    questionType: 'multiple_choice',
    options: [
      '90+ days',
      '30-89 days',
      '7-29 days',
      'Less than 7 days',
      'Unknown',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Less than 7 days'],
    riskWeight: 1,
    riskIndicators: ['less than 7 days'],
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'corporate_espionage'],
    suggestsControls: ['video_retention'],
  },
  {
    id: 'surveillance_5',
    section: 'Surveillance Systems',
    questionText: 'Is video analytics (motion detection, facial recognition, etc.) used?',
    questionType: 'multiple_choice',
    options: [
      'Advanced analytics (facial recognition, behavior)',
      'Motion detection only',
      'No video analytics',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    suggestsControls: ['video_analytics'],
  },
  {
    id: 'surveillance_6',
    section: 'Surveillance Systems',
    questionText: 'Is there CCTV coverage in sensitive areas (server room, executive suite)?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'executive_targeting', 'insider_threat'],
    suggestsControls: ['sensitive_area_cctv'],
  },
  {
    id: 'surveillance_7',
    section: 'Surveillance Systems',
    questionText: 'Are cameras positioned to capture facial images at entry points?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence'],
    suggestsControls: ['facial_capture_cameras'],
  },
  {
    id: 'surveillance_8',
    section: 'Surveillance Systems',
    questionText: 'When was the CCTV system last upgraded or assessed?',
    questionType: 'multiple_choice',
    options: [
      'Within last year',
      '1-3 years ago',
      '3-5 years ago',
      'Over 5 years ago',
      'Unknown',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Over 5 years ago'],
    riskWeight: 1,
    riskIndicators: ['over 5 years'],
    informsVulnerability: true,
  },
];

// ============================================================================
// SECTION 7: INTRUSION DETECTION (6 questions)
// ============================================================================

const SECTION_7_INTRUSION: InterviewQuestion[] = [
  {
    id: 'intrusion_1',
    section: 'Intrusion Detection',
    questionText: 'Is there an intrusion detection/alarm system installed?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 2,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'theft_burglary'],
    suggestsControls: ['intrusion_detection_system'],
  },
  {
    id: 'intrusion_2',
    section: 'Intrusion Detection',
    questionText: 'What areas are covered by intrusion detection?',
    questionType: 'checklist',
    options: [
      'All perimeter doors',
      'Windows (ground floor)',
      'Motion sensors in common areas',
      'Server room/IT areas',
      'Executive areas',
      'Roof access points',
      'Loading dock',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'theft_burglary'],
  },
  {
    id: 'intrusion_3',
    section: 'Intrusion Detection',
    questionText: 'Is the alarm system monitored by a central station?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 2,
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'theft_burglary'],
    suggestsControls: ['central_station_monitoring'],
  },
  {
    id: 'intrusion_4',
    section: 'Intrusion Detection',
    questionText: 'Are there panic/duress alarms available to employees?',
    questionType: 'multiple_choice',
    options: [
      'Yes - at multiple locations (reception, executive suite, etc.)',
      'Yes - at reception only',
      'Mobile panic buttons available',
      'No panic alarms',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No panic alarms'],
    riskWeight: 2,
    riskIndicators: ['no panic alarms'],
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'active_shooter', 'executive_targeting'],
    suggestsControls: ['panic_alarms'],
  },
  {
    id: 'intrusion_5',
    section: 'Intrusion Detection',
    questionText: 'How quickly do police typically respond to alarms at this location?',
    questionType: 'multiple_choice',
    options: [
      'Under 5 minutes',
      '5-10 minutes',
      '10-20 minutes',
      'Over 20 minutes',
      'Unknown',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsImpact: true,
    informsThreat: ['after_hours_intrusion', 'active_shooter'],
  },
  {
    id: 'intrusion_6',
    section: 'Intrusion Detection',
    questionText: 'When was the alarm system last tested?',
    questionType: 'multiple_choice',
    options: [
      'Within last month',
      '1-6 months ago',
      '6-12 months ago',
      'Over a year ago',
      'Unknown/never tested',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Over a year ago', 'Unknown/never tested'],
    riskWeight: 1,
    riskIndicators: ['over a year', 'never tested'],
    informsVulnerability: true,
    suggestsControls: ['alarm_testing_program'],
  },
];

// ============================================================================
// SECTION 8: SECURITY PERSONNEL & PROCEDURES (10 questions)
// ============================================================================

const SECTION_8_PERSONNEL: InterviewQuestion[] = [
  {
    id: 'personnel_1',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there a dedicated security officer presence at the building?',
    questionType: 'multiple_choice',
    options: [
      '24/7 armed security',
      '24/7 unarmed security',
      'Business hours only',
      'Part-time/occasional',
      'No security personnel',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No security personnel'],
    riskWeight: 2,
    riskIndicators: ['no security personnel'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'workplace_violence', 'active_shooter'],
    suggestsControls: ['security_officers'],
  },
  {
    id: 'personnel_2',
    section: 'Security Personnel & Procedures',
    questionText: 'Are security officers contract or proprietary?',
    questionType: 'multiple_choice',
    options: [
      'Proprietary (in-house employees)',
      'Contract with dedicated officers',
      'Contract with rotating officers',
      'Mix of proprietary and contract',
      'Not applicable',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsVulnerability: true,
  },
  {
    id: 'personnel_3',
    section: 'Security Personnel & Procedures',
    questionText: 'Do security officers conduct regular patrols?',
    questionType: 'multiple_choice',
    options: [
      'Yes - scheduled and random patrols',
      'Yes - scheduled patrols only',
      'Occasional patrols',
      'No patrols',
      'Not applicable',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No patrols'],
    riskWeight: 1,
    riskIndicators: ['no patrols'],
    informsVulnerability: true,
    informsThreat: ['after_hours_intrusion', 'theft_burglary'],
    suggestsControls: ['security_patrols'],
  },
  {
    id: 'personnel_4',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there a security operations center (SOC) or command post?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'active_shooter'],
    suggestsControls: ['security_operations_center'],
  },
  {
    id: 'personnel_5',
    section: 'Security Personnel & Procedures',
    questionText: 'Are employee background checks conducted?',
    questionType: 'multiple_choice',
    options: [
      'Comprehensive (criminal, credit, references)',
      'Criminal background only',
      'For sensitive positions only',
      'No background checks',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No background checks'],
    riskWeight: 2,
    riskIndicators: ['no background checks'],
    informsVulnerability: true,
    informsThreat: ['insider_threat', 'theft_burglary', 'workplace_violence'],
    suggestsControls: ['background_checks'],
  },
  {
    id: 'personnel_6',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there security awareness training for employees?',
    questionType: 'multiple_choice',
    options: [
      'Annual mandatory training with testing',
      'Annual training (no testing)',
      'New hire orientation only',
      'No security training',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No security training'],
    riskWeight: 1,
    riskIndicators: ['no security training'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage', 'workplace_violence'],
    suggestsControls: ['security_training'],
  },
  {
    id: 'personnel_7',
    section: 'Security Personnel & Procedures',
    questionText: 'Are there documented security policies and procedures?',
    questionType: 'multiple_choice',
    options: [
      'Comprehensive and regularly updated',
      'Basic policies exist',
      'Informal/undocumented',
      'No policies',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Informal/undocumented', 'No policies'],
    riskWeight: 1,
    riskIndicators: ['informal', 'no policies'],
    informsVulnerability: true,
    suggestsControls: ['security_policies'],
  },
  {
    id: 'personnel_8',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there a workplace violence prevention program?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 2,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'active_shooter'],
    suggestsControls: ['workplace_violence_prevention'],
  },
  {
    id: 'personnel_9',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there a threat assessment team or process?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'executive_targeting'],
    suggestsControls: ['threat_assessment_team'],
  },
  {
    id: 'personnel_10',
    section: 'Security Personnel & Procedures',
    questionText: 'Is there an anonymous reporting system for security concerns?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'insider_threat'],
    suggestsControls: ['anonymous_reporting'],
  },
];

// ============================================================================
// SECTION 9: EMERGENCY PREPAREDNESS (10 questions)
// ============================================================================

const SECTION_9_EMERGENCY: InterviewQuestion[] = [
  {
    id: 'emergency_1',
    section: 'Emergency Preparedness',
    questionText: 'Is there a documented emergency response plan?',
    questionType: 'multiple_choice',
    options: [
      'Comprehensive plan reviewed annually',
      'Basic plan exists',
      'Informal procedures only',
      'No emergency plan',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Informal procedures only', 'No emergency plan'],
    riskWeight: 2,
    riskIndicators: ['informal', 'no emergency plan'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'terrorism_bomb_threat', 'workplace_violence'],
    suggestsControls: ['emergency_response_plan'],
  },
  {
    id: 'emergency_2',
    section: 'Emergency Preparedness',
    questionText: 'Is there a mass notification system?',
    questionType: 'multiple_choice',
    options: [
      'Multi-channel (text, email, PA, app)',
      'Email and text only',
      'PA system only',
      'No mass notification capability',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No mass notification capability'],
    riskWeight: 2,
    riskIndicators: ['no mass notification'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'terrorism_bomb_threat', 'civil_disturbance'],
    suggestsControls: ['mass_notification_system'],
  },
  {
    id: 'emergency_3',
    section: 'Emergency Preparedness',
    questionText: 'How often are evacuation drills conducted?',
    questionType: 'multiple_choice',
    options: [
      'Quarterly',
      'Semi-annually',
      'Annually',
      'Less than annually',
      'Never',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Less than annually', 'Never'],
    riskWeight: 1,
    riskIndicators: ['less than annually', 'never'],
    informsVulnerability: true,
    informsThreat: ['terrorism_bomb_threat', 'active_shooter'],
    suggestsControls: ['evacuation_drills'],
  },
  {
    id: 'emergency_4',
    section: 'Emergency Preparedness',
    questionText: 'Is there Run-Hide-Fight or active shooter training?',
    questionType: 'multiple_choice',
    options: [
      'Annual training for all employees',
      'New hire training only',
      'Optional/available training',
      'No active shooter training',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No active shooter training'],
    riskWeight: 2,
    riskIndicators: ['no active shooter training'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'workplace_violence'],
    suggestsControls: ['active_shooter_training'],
  },
  {
    id: 'emergency_5',
    section: 'Emergency Preparedness',
    questionText: 'Is there a building lockdown capability?',
    questionType: 'multiple_choice',
    options: [
      'Yes - centralized instant lockdown',
      'Yes - zone-by-zone lockdown',
      'Manual lockdown only',
      'No lockdown capability',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No lockdown capability'],
    riskWeight: 2,
    riskIndicators: ['no lockdown'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'workplace_violence', 'civil_disturbance'],
    suggestsControls: ['lockdown_capability'],
  },
  {
    id: 'emergency_6',
    section: 'Emergency Preparedness',
    questionText: 'Are there designated safe rooms or shelter areas?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'terrorism_bomb_threat'],
    suggestsControls: ['safe_rooms'],
  },
  {
    id: 'emergency_7',
    section: 'Emergency Preparedness',
    questionText: 'Is there a relationship with local law enforcement?',
    questionType: 'multiple_choice',
    options: [
      'Regular liaison and facility tours',
      'Contact established',
      'No formal relationship',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No formal relationship'],
    riskWeight: 1,
    riskIndicators: ['no formal relationship'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'terrorism_bomb_threat'],
    suggestsControls: ['law_enforcement_liaison'],
  },
  {
    id: 'emergency_8',
    section: 'Emergency Preparedness',
    questionText: 'Are first aid/AED stations readily accessible?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['workplace_violence', 'active_shooter'],
    suggestsControls: ['first_aid_stations'],
  },
  {
    id: 'emergency_9',
    section: 'Emergency Preparedness',
    questionText: 'Is there a business continuity plan?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsImpact: true,
    informsThreat: ['terrorism_bomb_threat', 'civil_disturbance'],
    suggestsControls: ['business_continuity_plan'],
  },
  {
    id: 'emergency_10',
    section: 'Emergency Preparedness',
    questionText: 'Are emergency procedures communicated to all employees?',
    questionType: 'multiple_choice',
    options: [
      'Yes - regular reminders and posted procedures',
      'Yes - during onboarding',
      'Limited communication',
      'No communication',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Limited communication', 'No communication'],
    riskWeight: 1,
    riskIndicators: ['limited', 'no communication'],
    informsVulnerability: true,
    informsThreat: ['active_shooter', 'terrorism_bomb_threat'],
    suggestsControls: ['emergency_communication'],
  },
];

// ============================================================================
// SECTION 10: INCIDENT HISTORY (6 questions)
// ============================================================================

const SECTION_10_INCIDENTS: InterviewQuestion[] = [
  {
    id: 'incident_1',
    section: 'Incident History Analysis',
    questionText: 'Have there been any security incidents at this facility in the past 3 years?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    badAnswers: ['yes'],
    riskWeight: 2,
    riskIndicators: ['yes'],
    informsThreat: ['unauthorized_access', 'workplace_violence', 'theft_burglary'],
  },
  {
    id: 'incident_2',
    section: 'Incident History Analysis',
    questionText: 'What types of incidents have occurred? (Select all that apply)',
    questionType: 'checklist',
    options: [
      'Unauthorized access/tailgating',
      'Theft (employee or visitor)',
      'Workplace violence/threats',
      'Vandalism',
      'After-hours intrusion',
      'Data breach (physical)',
      'Executive harassment/threats',
      'Bomb threat',
      'None of the above',
    ],
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsThreat: ['unauthorized_access', 'theft_burglary', 'workplace_violence', 'after_hours_intrusion'],
  },
  {
    id: 'incident_3',
    section: 'Incident History Analysis',
    questionText: 'Have any incidents resulted in injuries?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    badAnswers: ['yes'],
    riskWeight: 2,
    riskIndicators: ['yes'],
    informsImpact: true,
    informsThreat: ['workplace_violence'],
  },
  {
    id: 'incident_4',
    section: 'Incident History Analysis',
    questionText: 'Have any incidents resulted in police involvement?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_BAD',
    badAnswers: ['yes'],
    riskWeight: 1,
    riskIndicators: ['yes'],
    informsImpact: true,
  },
  {
    id: 'incident_5',
    section: 'Incident History Analysis',
    questionText: 'Is there a formal incident tracking/reporting system?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    suggestsControls: ['incident_tracking_system'],
  },
  {
    id: 'incident_6',
    section: 'Incident History Analysis',
    questionText: 'Are incidents investigated and lessons learned documented?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    suggestsControls: ['incident_investigation_process'],
  },
];

// ============================================================================
// SECTION 11: CYBER-PHYSICAL SECURITY (6 questions)
// ============================================================================

const SECTION_11_CYBER_PHYSICAL: InterviewQuestion[] = [
  {
    id: 'cyber_1',
    section: 'Cyber-Physical Security',
    questionText: 'Are physical security systems (access control, CCTV) on an isolated network?',
    questionType: 'multiple_choice',
    options: [
      'Yes - dedicated security network',
      'VLAN segregated',
      'Shared with corporate network',
      'Unknown',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Shared with corporate network'],
    riskWeight: 1,
    riskIndicators: ['shared with corporate'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat'],
    suggestsControls: ['network_segregation'],
  },
  {
    id: 'cyber_2',
    section: 'Cyber-Physical Security',
    questionText: 'Are default passwords changed on all security devices?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 2,
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat'],
    suggestsControls: ['password_management'],
  },
  {
    id: 'cyber_3',
    section: 'Cyber-Physical Security',
    questionText: 'Are security systems regularly updated/patched?',
    questionType: 'multiple_choice',
    options: [
      'Yes - on a regular schedule',
      'Occasionally',
      'Only when issues arise',
      'Never/unknown',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Only when issues arise', 'Never/unknown'],
    riskWeight: 1,
    riskIndicators: ['only when issues', 'never'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical'],
    suggestsControls: ['patch_management'],
  },
  {
    id: 'cyber_4',
    section: 'Cyber-Physical Security',
    questionText: 'Is remote access to security systems controlled?',
    questionType: 'multiple_choice',
    options: [
      'VPN with multi-factor authentication',
      'VPN only',
      'Direct access with password',
      'No remote access allowed',
      'Unknown',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Direct access with password'],
    riskWeight: 1,
    riskIndicators: ['direct access with password'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat'],
    suggestsControls: ['remote_access_control'],
  },
  {
    id: 'cyber_5',
    section: 'Cyber-Physical Security',
    questionText: 'Are access control and CCTV system logs retained?',
    questionType: 'multiple_choice',
    options: [
      'Yes - 90+ days with tamper protection',
      'Yes - 30-90 days',
      'Yes - less than 30 days',
      'No log retention',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No log retention'],
    riskWeight: 1,
    riskIndicators: ['no log retention'],
    informsVulnerability: true,
    informsThreat: ['insider_threat', 'data_breach_physical'],
    suggestsControls: ['audit_logging'],
  },
  {
    id: 'cyber_6',
    section: 'Cyber-Physical Security',
    questionText: 'Are there USB/removable media policies for security workstations?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat'],
    suggestsControls: ['removable_media_policy'],
  },
];

// ============================================================================
// SECTION 12: DOCUMENT & DATA SECURITY (6 questions)
// ============================================================================

const SECTION_12_DATA_SECURITY: InterviewQuestion[] = [
  {
    id: 'data_1',
    section: 'Document & Data Security',
    questionText: 'Is there a clean desk policy?',
    questionType: 'multiple_choice',
    options: [
      'Yes - enforced with regular audits',
      'Yes - policy exists',
      'Informal expectation',
      'No policy',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Informal expectation', 'No policy'],
    riskWeight: 1,
    riskIndicators: ['informal', 'no policy'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'corporate_espionage'],
    suggestsControls: ['clean_desk_policy'],
  },
  {
    id: 'data_2',
    section: 'Document & Data Security',
    questionText: 'Is secure document destruction available?',
    questionType: 'multiple_choice',
    options: [
      'On-site shredding with audit trail',
      'Shred bins with vendor pickup',
      'Personal shredders available',
      'No secure destruction',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['No secure destruction'],
    riskWeight: 1,
    riskIndicators: ['no secure destruction'],
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'corporate_espionage'],
    suggestsControls: ['document_destruction'],
  },
  {
    id: 'data_3',
    section: 'Document & Data Security',
    questionText: 'Is secure print release (badge to print) implemented?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['data_breach_physical', 'insider_threat'],
    suggestsControls: ['secure_print'],
  },
  {
    id: 'data_4',
    section: 'Document & Data Security',
    questionText: 'Are meeting rooms checked for tailgaters/unauthorized attendees?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['corporate_espionage', 'data_breach_physical'],
    suggestsControls: ['meeting_room_security'],
  },
  {
    id: 'data_5',
    section: 'Document & Data Security',
    questionText: 'Is photography/recording restricted in sensitive areas?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['corporate_espionage', 'data_breach_physical'],
    suggestsControls: ['photography_policy'],
  },
  {
    id: 'data_6',
    section: 'Document & Data Security',
    questionText: 'Are privacy screens used on monitors in open areas?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['corporate_espionage', 'data_breach_physical'],
    suggestsControls: ['privacy_screens'],
  },
];

// ============================================================================
// SECTION 13: LOADING DOCK & RECEIVING (6 questions)
// ============================================================================

const SECTION_13_LOADING_DOCK: InterviewQuestion[] = [
  {
    id: 'dock_1',
    section: 'Loading Dock & Receiving',
    questionText: 'Does the building have a loading dock or receiving area?',
    questionType: 'yes_no',
    required: true,
    polarity: 'CONTEXT',
    riskWeight: 0,
    informsThreat: ['unauthorized_access', 'terrorism_bomb_threat'],
  },
  {
    id: 'dock_2',
    section: 'Loading Dock & Receiving',
    questionText: 'Is the loading dock access-controlled?',
    questionType: 'multiple_choice',
    options: [
      'Badge access with scheduling',
      'Badge access only',
      'Manual gate/door',
      'Open access',
      'Not applicable',
    ],
    required: true,
    polarity: 'MULTIPLE_CHOICE',
    badAnswers: ['Open access'],
    riskWeight: 1,
    riskIndicators: ['open access'],
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'theft_burglary'],
    suggestsControls: ['loading_dock_access_control'],
  },
  {
    id: 'dock_3',
    section: 'Loading Dock & Receiving',
    questionText: 'Is there CCTV coverage of the loading dock?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['theft_burglary', 'unauthorized_access'],
    suggestsControls: ['loading_dock_cctv'],
  },
  {
    id: 'dock_4',
    section: 'Loading Dock & Receiving',
    questionText: 'Is there a separate mail/package screening area?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['terrorism_bomb_threat'],
    suggestsControls: ['mail_screening'],
  },
  {
    id: 'dock_5',
    section: 'Loading Dock & Receiving',
    questionText: 'Are delivery personnel verified before allowing access?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'corporate_espionage'],
    suggestsControls: ['delivery_verification'],
  },
  {
    id: 'dock_6',
    section: 'Loading Dock & Receiving',
    questionText: 'Is the loading dock separated from main building areas?',
    questionType: 'yes_no',
    required: true,
    polarity: 'YES_GOOD',
    badAnswers: ['no'],
    riskWeight: 1,
    informsVulnerability: true,
    informsThreat: ['unauthorized_access', 'terrorism_bomb_threat'],
    suggestsControls: ['loading_dock_separation'],
  },
];

// ============================================================================
// COMBINED EXPORT
// ============================================================================

export const OFFICE_INTERVIEW_QUESTIONS: InterviewQuestion[] = [
  ...SECTION_1_FACILITY_OVERVIEW,
  ...SECTION_2_PERIMETER_SECURITY,
  ...SECTION_3_PARKING,
  ...SECTION_4_ENTRY_POINTS,
  ...SECTION_5_INTERIOR_ACCESS,
  ...SECTION_6_SURVEILLANCE,
  ...SECTION_7_INTRUSION,
  ...SECTION_8_PERSONNEL,
  ...SECTION_9_EMERGENCY,
  ...SECTION_10_INCIDENTS,
  ...SECTION_11_CYBER_PHYSICAL,
  ...SECTION_12_DATA_SECURITY,
  ...SECTION_13_LOADING_DOCK,
];

// ============================================================================
// HELPER FUNCTIONS
// ============================================================================

export function getQuestionsBySection(section: OfficeSection): InterviewQuestion[] {
  return OFFICE_INTERVIEW_QUESTIONS.filter(q => q.section === section);
}

export function getQuestionById(id: string): InterviewQuestion | undefined {
  return OFFICE_INTERVIEW_QUESTIONS.find(q => q.id === id);
}

export function getSectionMetadata(): SectionMetadata[] {
  return OFFICE_SECTIONS.map((section, index) => ({
    id: `section_${index + 1}`,
    name: section,
    description: `${section} assessment questions`,
    order: index + 1,
  }));
}

export function getQuestionnaireStats() {
  const questions = OFFICE_INTERVIEW_QUESTIONS;
  const withOptions = questions.filter(q => q.options && q.options.length > 0);
  const withFollowUps = questions.filter(q => q.followUpQuestions && q.followUpQuestions.length > 0);
  
  return {
    totalQuestions: questions.length,
    questionsWithOptions: withOptions.length,
    questionsWithFollowUps: withFollowUps.length,
    sections: OFFICE_SECTIONS.length,
    threats: OFFICE_THREATS.length,
  };
}

export function getCriticalQuestionsForThreat(threatId: string): string[] {
  const criticalQuestionMap: Record<string, string[]> = {
    unauthorized_access: ['entry_2', 'entry_4', 'entry_7', 'interior_1', 'personnel_1'],
    workplace_violence: ['personnel_1', 'personnel_8', 'emergency_4', 'intrusion_4', 'overview_5'],
    theft_burglary: ['parking_2', 'surveillance_1', 'intrusion_1', 'personnel_5'],
    executive_targeting: ['parking_5', 'interior_3', 'personnel_9', 'overview_5'],
    data_breach_physical: ['interior_2', 'data_1', 'data_2', 'cyber_1'],
    terrorism_bomb_threat: ['perimeter_6', 'entry_9', 'emergency_1', 'dock_4'],
    civil_disturbance: ['emergency_1', 'emergency_2', 'emergency_5'],
    insider_threat: ['personnel_5', 'interior_6', 'interior_7', 'cyber_5'],
    after_hours_intrusion: ['intrusion_1', 'intrusion_3', 'entry_10', 'perimeter_4'],
    vehicle_ramming: ['perimeter_1', 'perimeter_6', 'perimeter_7'],
    active_shooter: ['emergency_4', 'emergency_5', 'intrusion_4', 'personnel_1'],
    corporate_espionage: ['entry_4', 'entry_6', 'data_1', 'data_5'],
  };
  
  return criticalQuestionMap[threatId] || [];
}

export default OFFICE_INTERVIEW_QUESTIONS;
