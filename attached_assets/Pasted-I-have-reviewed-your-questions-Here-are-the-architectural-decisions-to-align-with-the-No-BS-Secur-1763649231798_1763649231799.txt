I have reviewed your questions. Here are the architectural decisions to align with the "No BS" Security Framework. Please execute Phase 2 using these specific directives:Decision 1: Control Weights StrategyðŸ‘‰ Selection: Option A (Database Driven)Action: Add a weight column (Float) and controlType column (String enum) to the existing control_library table.Logic: We must be able to tune weights without redeploying code.Seed Data Update:PREVENTATIVE (Locks, Fences) = 0.40DETECTIVE (CCTV, Alarms) = 0.20PROCEDURAL (Policies, Logs) = 0.10ACTIVE (Guards, Biometrics) = 0.50Decision 2: Answer Options ArchitectureðŸ‘‰ Selection: Option C (Simplified Mapping)Action: Do not create a complex new table for modifiers yet. Instead, add a helper function in riskCalculations.ts that maps standard response types to Implementation Fidelity ($F$):"Yes" / "Compliant" / "Functioning" $\rightarrow$ 1.0"Partial" / "Inconsistent" $\rightarrow$ 0.5"No" / "Missing" / "Malfunctioning" $\rightarrow$ 0.0Why: This keeps the database clean while ensuring the math works immediately.Decision 3: Question-Threat MappingðŸ‘‰ Selection: Option A (Explicit Many-to-Many Table)Action: Create a junction table QuestionThreatMap (or QuestionRiskFactors).Fields: question_id, threat_id, impact_driver (Boolean).Why: A single question (e.g., "Is the perimeter fence intact?") affects multiple threats (Theft, Vandalism, Unauthorized Entry). We need explicit links to calculate scores accurately.Decision 4: Vulnerability (V) & Formula SimplificationðŸ‘‰ Selection: Modified FormulaAction: For this MVP, do not calculate $V$ as a dynamic floating variable (it is too complex for V1).Use this specific formula:Inherent Risk ($R_{inh}$) = Threat Likelihood ($L$) $\times$ Asset Criticality ($I$).Range: 1 to 25.Control Effectiveness ($C_e$) = $\sum$ (Control Weight $\times$ Answer Fidelity).Cap: Max 0.95.Residual Risk ($R_{res}$) = $R_{inh} \times (1 - C_e)$.Note: Treat "Vulnerability" as "100%" in the Inherent state. The Controls reduce the vulnerability.Decision 5: ScopeðŸ‘‰ Selection: Full Scope (Include Treatments)Action: Build the Treatments table now.Why: The core value proposition is the "Roadmap." We must show the client: "If you add this Treatment, your Residual Risk drops from 15 to 8." We need the Treatments entity to calculate that future state.Updated Implementation Plan (Execute This)1. Schema Changes (shared/schema.ts)Update control_library: Add weight (Float), category_type (Enum).Create risk_scenarios: Fields for threat_id, asset_id, likelihood_score, inherent_risk, residual_risk.Create treatments: Fields for scenario_id, proposed_control_id, cost_estimate, new_residual_risk.Create question_threat_map: Junction table.2. Calculation Service (server/services/riskEngine.ts)Implement the Cascading Calculation:Trigger: When SurveyResponse is updated $\rightarrow$ Find linked Threats $\rightarrow$ Recalculate $C_e$ $\rightarrow$ Update RiskScenario.3. API LayerGET /api/assessments/:id/heatmap: Return scenarios grouped by risk band (Low: 1-5, Med: 6-12, High: 13-25).POST /api/assessments/:id/treatments: Create a mitigation plan and return the projected risk reduction.4. FrontendBuild the 5x5 Heatmap Component.Build the Risk Register Table showing: Threat | Inherent Score | Active Controls | Residual Score.